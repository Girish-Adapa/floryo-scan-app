


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Barcode Scanner</title>
  <!-- Include QuaggaJS library -->
  <script src="https://cdn.jsdelivr.net/npm/quagga/dist/quagga.min.js"></script>
</head>
<body>
  <button onclick="handleScanBarcode()">Scan Barcode</button>

  <script>
    async function handleScanBarcode() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({
          video: {
            facingMode: 'environment', // Use the rear-facing camera
            width: { min: 640, ideal: 1280, max: 1920 }, // Video width constraints
            height: { min: 480, ideal: 720, max: 1080 }, // Video height constraints
            aspectRatio: 16/9 // Aspect ratio constraints
          }
        });

        // Use the stream to initialize the barcode scanner
        initializeBarcodeScanner(stream);
      } catch (error) {
        console.error('Error accessing camera:', error);
        alert('Failed to access camera. Please provide camera permission.');
      }
    }

    function initializeBarcodeScanner(stream) {
      Quagga.init({
        inputStream: {
          name: 'Live',
          type: 'LiveStream',
          target: document.querySelector('#scanner-container'), // Container to render scanner
          constraints: {
            width: 640, // Adjust width and height as needed
            height: 480,
            facingMode: 'environment' // Use the rear-facing camera
          }
        },
        decoder: {
          readers: ['ean_reader'] // Supported barcode types (EAN-13, UPC-A, etc.)
        }
      }, function (err) {
        if (err) {
          console.error('Error initializing barcode scanner:', err);
          alert('Failed to initialize barcode scanner.');
          return;
        }
        console.log('Barcode scanner initialized successfully.');
        Quagga.start();
      });

      // Attach event listeners for successful barcode detection
      Quagga.onDetected((data) => {
        console.log('Barcode detected:', data.codeResult.code);
        // Handle the detected barcode here, such as displaying it on the page
        alert('Barcode detected: ' + data.codeResult.code);
        // Stop the scanner after a successful detection
        Quagga.stop();
      });
    }
  </script>
</body>
</html>

